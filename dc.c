#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include <conio.h>
#include <locale.h>
#include <stdbool.h>

#define parede 1
#define vazio 0
#define espinho 2
#define key 3
#define button1 4
#define door_closed 6
#define door_open 7
#define player 9
#define door2 10
#define tp1f2 13
#define tp2f2 14
#define od 15
#define od2 16
#define dc 17
#define buttonf31 18
#define doorf31 19
#define doorfo31 30
#define buttonf32 20
#define doorf32 21
#define doorfo32 31
#define tp1f3 22
#define tp2f3 23
#define tp3f3 24
#define tp4f3 25
#define WIN 26



//fase 1
int linha1 = 13;
int coluna1 = 2;
bool end1 = false;
//fase 2
int linha2 = 28;
int coluna2 = 3;
int mlinha = 3;
int mcoluna = 27;
bool end2 = false; 
//fase 3
int linha3 = 58;
int coluna3 = 3;
bool end3 = false;
int mlinha2 = 3;
int mcoluna2= 57;
//variáveis gerais
char tecla;
bool havekey = false;
bool pressbutton = false;
bool pressbutton1 = false;
bool pressbutton2 = false;
bool presstp = false;
int life = 3;

//funcs para o menu
void linhaCol(int lin, int col);
void box(int lin1, int col1, int lin2, int col2);
int menu(int lin1, int col1, int qtd, char lista[3][40]);
void textColor(int letras, int fundo);

//funcs para o jogo
void linhaCol1(int lin, int col);


  //COR DA LETRA
  enum{BLACK,                 //0
       BLUE,                  //1
       GREEN,                 //2
       CYAN,                  //3
       RED,                   //4
       MAGENTA,               //5
       BROWN,                 //6
       LIGHTGRAY,             //7
       DARKGRAY,              //8
       LIGHTBLUE,             //9
       LIGHTGREEN,            //10
       LIGHTCYAN,             //11
       LIGHTRED,              //12
       LIGHTMAGENTA,          //13
       YELLOW,                //14
       WHITE                  //15
       
       };  
  //COR DO FUNDO
  enum{_BLACK=0,                 //0
       _BLUE=16,                  //1
       _GREEN=32,                 //2
       _CYAN=48,                  //3
       _RED=64,                   //4
       _MAGENTA=80,               //5
       _BROWN=96,                 //6
       _LIGHTGRAY=112,             //7
       _DARKGRAY=128,              //8
       _LIGHTBLUE=144,             //9
       _LIGHTGREEN=160,            //10
       _LIGHTCYAN=176,             //11
       _LIGHTRED=192,              //12
       _LIGHTMAGENTA=208,          //13
       _YELLOW=224,                //14
       _WHITE=240                  //15      
       };  
       

void textColor(int letra, int fundo){
     SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), letra + fundo);
     }
     
void linhaCol(int lin, int col){
     SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE),(COORD){col-1,lin-1});// coorddenada na tela
     
     //funcao para deixar o cursor invisivel
     HANDLE consoleHandle = GetStdHandle(STD_OUTPUT_HANDLE);
     CONSOLE_CURSOR_INFO info;
     info.dwSize = 100;
     info.bVisible = FALSE;
     SetConsoleCursorInfo(consoleHandle, &info);
}
void linhaCol1(int lin, int col){
     SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE),(COORD){col,lin});// coorddenada na tela
     
     //funcao para deixar o cursor invisivel
     HANDLE consoleHandle = GetStdHandle(STD_OUTPUT_HANDLE);
     CONSOLE_CURSOR_INFO info;
     info.dwSize = 100;
     info.bVisible = FALSE;
     SetConsoleCursorInfo(consoleHandle, &info);
}

void box(int lin1, int col1, int lin2, int col2){
     int i,j , tamlin, tamcol;
     
     //achar o tamanho do box
     tamlin = lin2 - lin1;
     tamcol = col2 - col1;
     
     //Monta o Box
     
     for (i=col1; i<=col2; i++){ // linhas
         linhaCol(lin1,i);
         printf("%c",196);
         linhaCol(lin2,i);
         printf("%c",196);
         }
       
     for (i=lin1; i<=lin2; i++){ //colunas
         linhaCol(i,col1);
         printf("%c",179);
         linhaCol(i,col2);
         printf("%c",179);
         }
     for (i=lin1+1;i<lin2;i++){
         for(j=col1+1;j<col2;j++){
            linhaCol(i,j);printf(" ");
         }
         }
     //Posição dos cantos
     linhaCol(lin1,col1);
     printf("%c",218);
     linhaCol(lin1,col2);
     printf("%c",191);
     linhaCol(lin2,col1);
     printf("%c",192);
     linhaCol(lin2,col2);
     printf("%c",217);      
     
     }
int menu(int lin1, int col1, int qtd, char lista[3][40]){
     int opc=1, lin2, col2, linha,i,tamMaxItem, tecla;
     
     //calcula as coordenadas
     tamMaxItem = strlen(lista[0]);
     //tamanho maximo do item
     for(i=1; i<qtd;i++){
       if(strlen(lista[i])>tamMaxItem){
          tamMaxItem = strlen(lista[i]);
       }
     }
     lin2 = lin1+(qtd*2+2);
     col2 = col1+tamMaxItem+4;
     
     //Monta Tela
     textColor(WHITE, _BLACK);
     setlocale(LC_ALL,"C");
     box(lin1,col1,lin2,col2);
     setlocale(LC_ALL,"");
     //laço das opcões
     while(1){
     
        linha=lin1+2;
        for(i=0;i<qtd;i++){          
           if(i+1==opc)textColor(BLACK, _WHITE);
           else textColor(WHITE, _BLACK);
        linhaCol(linha,col1+2);
        printf("%s",lista[i]);
        linha +=2;
        }
       
       //Aguarda tecla
       linhaCol(1,1);
       tecla= getch();
       linhaCol(22,1);
       //printf(" tecla:  %d   ",tecla);  
       //Opção
       if(tecla==27){ //ESC
       opc=0; break;
       }
       else if(tecla==13){ //ENTER
       break;
       }
       //Seta para cima
       else if(tecla==72){ //se possivel seleciona o item anterior - seta para cima
            if(opc>1)opc--;  // se opcao for maior que 1, pode voltar
       
       }
       else if(tecla==80 ){        //seta para baixo
            if (opc<qtd)opc++;                //Se opcao for menor que quantidade de itens, posso avançar
                 
                           
       //printf("tecla: %d ",opc);    
       }
     }
     return opc;
}    
int fase1[15][15] =

{
   
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,0,0,0,1,0,0,0,1,0,0,1,0,0,6},
{1,0,3,0,1,0,0,0,1,0,0,1,0,0,1},
{1,0,0,0,1,0,0,0,1,0,0,1,0,0,1},
{1,0,0,0,1,0,0,0,1,0,0,1,0,0,1},
{1,0,0,1,1,0,0,0,1,0,0,1,0,0,1},
{1,0,1,1,0,0,1,0,1,0,0,1,0,0,1},
{1,0,1,0,0,1,1,0,1,0,0,1,0,0,1},
{1,0,1,0,0,1,0,0,1,0,1,1,0,0,1},
{1,0,1,0,0,1,0,0,1,0,1,0,0,0,1},
{1,0,0,0,0,1,0,0,1,0,1,0,0,0,1},
{1,0,0,0,0,1,0,0,1,1,1,0,0,0,1},
{1,0,0,0,0,1,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,1,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
   
   
};

int cfase1[15][15] =

{
   
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,0,0,0,1,0,0,0,1,0,0,1,0,0,6},
{1,0,3,0,1,0,0,0,1,0,0,1,0,0,1},
{1,0,0,0,1,0,0,0,1,0,0,1,0,0,1},
{1,0,0,0,1,0,0,0,1,0,0,1,0,0,1},
{1,0,0,1,1,0,0,0,1,0,0,1,0,0,1},
{1,0,1,1,0,0,1,0,1,0,0,1,0,0,1},
{1,0,1,0,0,1,1,0,1,0,0,1,0,0,1},
{1,0,1,0,0,1,0,0,1,0,1,1,0,0,1},
{1,0,1,0,0,1,0,0,1,0,1,0,0,0,1},
{1,0,0,0,0,1,0,0,1,0,1,0,0,0,1},
{1,0,0,0,0,1,0,0,1,1,1,0,0,0,1},
{1,0,0,0,0,1,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,1,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
   
   
};
int fase2[30][30] =

{
   
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,2,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,0,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,0,2,1,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,10,0,0,0,0,1,0,0,1},
{1,2,0,0,2,1,0,2,0,0,0,0,2,2,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,1},
{1,2,0,2,2,1,0,2,2,2,2,2,2,2,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,4,2,1,1,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1},
{1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,3,0,0,0,0,0,1},
{1,0,0,0,2,2,0,0,1,0,1,1,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,0,0,0,2,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1},
{1,0,0,0,0,2,2,0,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1},
{1,0,0,0,0,0,0,0,0,2,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,0,2,1,0,0,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,0,0,2,1,0,2,2,1,1,0,0,0,0,0,0,0,1,0,0,0,1,2,1,0,1},
{1,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1,2,2,1,0,1},
{1,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1,2,2,1,0,1},
{1,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,2,2,1,0,1},
{1,0,0,0,0,0,2,2,1,0,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,1,2,1,0,1},
{1,0,0,0,0,0,2,1,0,13,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,2,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,0,2,1,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1},
{1,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,2,2,1},
{1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,14,0,0,17},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,2,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
   
};

int cfase2[30][30] =

{
   
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,2,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,0,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,0,2,1,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,10,0,0,0,0,1,0,0,1},
{1,2,0,0,2,1,0,2,0,0,0,0,2,2,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,1},
{1,2,0,2,2,1,0,2,2,2,2,2,2,2,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,4,2,1,1,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1},
{1,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1},
{1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,3,0,0,0,0,0,1},
{1,0,0,0,2,2,0,0,1,0,1,1,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
{1,0,0,0,2,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1},
{1,0,0,0,0,2,2,0,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1},
{1,0,0,0,0,0,0,0,0,2,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,0,2,1,0,0,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,0,0,2,1,0,2,2,1,1,0,0,0,0,0,0,0,1,0,0,0,1,2,1,0,1},
{1,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1,2,2,1,0,1},
{1,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1,2,2,1,0,1},
{1,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,2,2,1,0,1},
{1,0,0,0,0,0,2,2,1,0,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,1,2,1,0,1},
{1,0,0,0,0,0,2,1,0,13,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,2,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
{1,0,0,0,0,0,2,1,2,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1},
{1,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,2,2,1},
{1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,14,0,0,17},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,2,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
   
};

int fase3[60][60] = 
{

{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,0,0,0,1,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,23,0,0,0,0,0,2,0,2,2,2,2,0,0,0,2,2,2,1,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,1,2,2,0,2,0,2,0,0,0,0,2,2,2,0,0,1,0,0,20,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,0,2,0,2,2,2,0,2,2,2,2,0,0,0,0,1,0,0,0,0,1,2,2,2,2,2,2,2,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,2,0,0,0,0,0,2,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,2,2,2,0,2,2,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,2,0,2,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,2,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,2,0,24,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,2,2,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,26,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,0,2,2,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,0,0,2,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,2,2,2,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,0,3,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,2,2,2,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,0,1,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,0,1,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,2,2,2,2,2,2,0,0,0,2,2,2,2,2,2,2,0,0,1,0,0,0,0,1,0,2,2,2,2,2,2,2,0,0,0,2,2,2,2,2,2,2,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,0,1,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,0,0,0,1,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,0,0,2,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,1,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,0,2,0,2,0,2,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,0,2,0,2,0,2,0,1,1,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,1,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,1,2,2,1,1,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,10,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{1,1,1,1,0,0,0,2,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,1,1,1,0,2,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0,1},
{1,0,0,0,0,1,1,2,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1},
{1,18,0,0,0,0,0,0,0,2,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,2,2,0,0,2,0,0,0,0,0,0,0,0,2,0,2,2,2,2,2,0,0,0,2,0,0,0,0,1},
{1,0,0,0,1,1,2,2,2,0,2,0,2,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,2,0,2,0,2,0,2,0,2,2,2,2,2,2,2,2,0,2,0,0,0,0,2,0,0,0,2,0,0,0,1},
{1,0,0,1,1,0,0,0,0,0,2,0,2,1,1,1,1,1,0,2,2,1,0,0,0,1,0,0,0,2,0,2,0,2,0,0,2,2,2,2,2,2,2,2,2,0,2,0,0,0,0,2,0,0,0,2,0,0,0,1},
{1,1,1,1,1,1,2,2,2,2,2,0,2,1,2,2,2,2,0,2,0,1,0,0,0,1,2,2,2,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,22,0,2,0,0,0,1},
{1,0,0,0,0,1,2,2,2,2,2,0,0,0,0,0,0,2,2,2,0,19,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,2,2,2,2,0,0,0,0,2,0,0,0,0,2,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,2,1,2,2,0,0,0,0,0,1,0,0,0,1,2,2,2,2,2,0,0,0,0,0,1,2,0,0,2,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,1},
{1,0,0,0,0,1,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
};


int cfase3[60][60] = 
{

{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,0,0,0,1,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,23,0,0,0,0,0,2,0,2,2,2,2,0,0,0,2,2,2,1,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,1,2,2,0,2,0,2,0,0,0,0,2,2,2,0,0,1,0,0,20,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,0,2,0,2,2,2,0,2,2,2,2,0,0,0,0,1,0,0,0,0,1,2,2,2,2,2,2,2,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,2,0,0,0,0,0,2,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,2,2,2,0,2,2,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,2,0,2,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,2,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,2,0,24,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,2,2,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,26,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,0,2,2,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,0,0,2,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,2,2,2,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,0,3,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,2,2,2,2,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,0,1,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,0,1,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,2,2,2,2,2,2,0,0,0,2,2,2,2,2,2,2,0,0,1,0,0,0,0,1,0,2,2,2,2,2,2,2,0,0,0,2,2,2,2,2,2,2,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,0,1,0,0,0,0,1,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,0,0,0,1,0,0,0,0,1,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,0,0,2,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,1,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,0,2,0,2,0,2,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,0,2,0,2,0,2,0,1,1,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,1,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,1,2,2,1,1,0,0,0,0,0,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,10,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,0,0,0,2,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,0,0,1,1,1,0,2,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0,1},
{1,0,0,0,0,1,1,2,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1},
{1,18,0,0,0,0,0,0,0,2,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,2,2,0,0,2,0,0,0,0,0,0,0,0,2,0,2,2,2,2,2,0,0,0,2,0,0,0,0,1},
{1,0,0,0,1,1,2,2,2,0,2,0,2,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,2,0,2,0,2,0,2,0,2,2,2,2,2,2,2,2,0,2,0,0,0,0,2,0,0,0,2,0,0,0,1},
{1,0,0,1,1,0,0,0,0,0,2,0,2,1,1,1,1,1,0,2,2,1,0,0,0,1,0,0,0,2,0,2,0,2,0,0,2,2,2,2,2,2,2,2,2,0,2,0,0,0,0,2,0,0,0,2,0,0,0,1},
{1,1,1,1,1,1,2,2,2,2,2,0,2,1,2,2,2,2,0,2,0,1,0,0,0,1,2,2,2,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,22,0,2,0,0,0,1},
{1,0,0,0,0,1,2,2,2,2,2,0,0,0,0,0,0,2,2,2,0,19,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,2,2,2,2,0,0,0,0,2,0,0,0,0,2,0,0,0,1},
{1,0,0,0,0,0,0,0,0,0,0,0,2,1,2,2,0,0,0,0,0,1,0,0,0,1,2,2,2,2,2,0,0,0,0,0,1,2,0,0,2,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,1},
{1,0,0,0,0,1,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
};



 

void imprimirMapa(int fase1[15][15]){
    int i;
    int j;
    for(i = 0; i < 15; i++){
        for(j = 0; j < 15; j++){
            switch(fase1[i][j]){
                case parede:
                    printf("\033[0;33m");
                    printf("*");
                    break;
                case vazio:
                    printf(" ");
                    break;
                case espinho:
                    printf("\033[0;31m");
                    printf("#");
                    break;
               case door_closed:
                    printf("\033[0;37m");
                    printf("D");
                    break;
                
                    case door_open:
                    printf("\033[1;30m");
                    printf("=");
                    break;
                case key:
                    printf("\033[0;32m");
                    printf("@");
                    break;
                
            }
        }
        printf("\n");
    }
    
}   


void imprimirMapa2(int fase2[30][30]){
    int i;
    int j;
    for(i = 0; i < 30; i++){
        for(j = 0; j < 30; j++){
            switch(fase2[i][j]){
                case parede:
                    printf("\033[0;33m");
                    printf("*");
                    break;
                case vazio:
                    printf(" ");
                    break;
                case espinho:
                    printf("\033[0;31m");
                    printf("#");
                    break;
                case door_closed:
                    printf("\033[0;37m");
                    printf("D");
                    break;
                    case door_open:
                    printf("\033[1;30m");
                    printf("=");
                    break;
                case key:
                    printf("\033[0;32m");
                    printf("@");
                    break;
                case button1:
                    printf("\033[1;33m");
                    printf("O");
                    break;
                case door2:
                    printf("\033[0;37m");
                    printf("D");
                    break;
                case tp1f2:
                printf("\033[0;35m");
                printf(">");
                break;
                case tp2f2:
                printf("\033[0;35m");
                printf(">");
                break;
                case od:
                printf("\033[1;30m");
                    printf("=");
                    break;
                case od2:
                 printf("\033[1;30m");
                    printf("=");
                    break;
                case dc:
                printf("\033[0;37m");
                    printf("D");
                    break;

                   
                   
            }
        }
        printf("\n");
    }
    
}   


void imprimirMapa3(int fase3[60][60]){
    int i;
    int j;
    for(i = 0; i < 60; i++){
        for(j = 0; j < 60; j++){
            switch(fase3[i][j]){
                case parede:
                    printf("\033[0;33m");
                    printf("*");
                    break;
                case vazio:
                    printf(" ");
                    break;
                case espinho:
                    printf("\033[0;31m");
                    printf("#");
                    break;
                case door_closed:
                    printf("\033[0;37m");
                    printf("D");
                    break;
                    case door_open:
                    printf("\033[1;30m");
                    printf("=");
                    break;
                case key:
                    printf("\033[0;32m");
                    printf("@");
                    break;
                case buttonf31:
                    printf("\033[1;33m");
                    printf("O");
                    break;
                case buttonf32:
                    printf("\033[1;33m");
                    printf("O");
                    break;
                case doorf31:
                    printf("\033[0;37m");
                    printf("D");
                    break;
                case doorf32:
                    printf("\033[0;37m");
                    printf("D");
                    break;
                case tp1f3:
                    printf("\033[0;35m");
                    printf(">");
                    break;
                case tp2f3:
                    printf("\033[0;35m");
                    printf(">");
                    break;
                case tp3f3:
                    printf("\033[0;35m");
                    printf(">");
                    break;
                case tp4f3:
                    printf("\033[0;35m");
                    printf(">");
                    break;
                case doorfo31:
                    printf("\033[1;30m");
                    printf("=");
                    break;
                case doorfo32:
                    printf("\033[1;30m");
                    printf("=");
                    break;
                case WIN:
                 printf("\033[1;30m");
                    printf("W");
                    break;
                   
                   
            }
        }
        printf("\n");
    }
    
}   



void resetGame1(){

    if(life == 0){
 
    imprimirMapa(cfase1);
    linha1 = 13;
    coluna1 = 2;
    havekey = false;
    life = 3;
    end1 = false;
}
}
void resetGame2(){
  if(life == 0){

    imprimirMapa2(cfase2);
    linha2 = 28;
    coluna2 = 3;
    havekey = false;
    mlinha = 3;
     mcoluna = 27;
    life = 3;
    end2 = false;
  }
}

void resetGame3(){
  if(life == 0){

    imprimirMapa3(cfase3);
    linha2 = 58;
    coluna2 = 3;
    havekey = false;
    pressbutton = false;
    life = 3;
    end3 = false;
  }
}


void Hist() {
    system("cls");
    textColor(WHITE, _BLACK);
    printf("\n\n\t\t\tDungeon Crawler: A Jornada do Cavaleiro\n\n");
    printf("\tNo reino de argo, um valente cavaleiro, Girotto, desafiou as ordens do rei em busca da verdade. Sua desobediencia resultou em sua prisao nas profundezas das masmorras do castelo.\n");
    printf("\tDeterminado a provar sua inocencia e descobrir os segredos do rei, Girotto embarca em uma jornada epica para escapar das garras sombrias do labirinto subterraneo\n\n");
    printf("\tA primeira fase do jogo o coloca em um labirinto inicial, repleto de paredes e inimigos traicoeiros. Voce deve encontrar chaves e abrir caminho para fora dessa prisao opressiva\n\n");
    printf("\tNa segunda fase, a tensao aumenta quando um caçador impiedoso eh enviado pelo rei para capturar o cavaleiro fugitivo\n");
    printf("\tAgora, alem de escapar dos perigos do labirinto, Girotto precisa evitar o olhar atento para espinhos e passagem secretas no caminho\n\n");
    printf("\tFinalmente, na terceira fase, a verdade por tras das ordens do rei começa a se revelar a medida que Girotto se aventura mais fundo nas entranhas da masmorra.\n");
    printf("\tEnfrentando desafios ainda maiores e monstros aterrorizantes, ele se aproxima do confronto final com o rei tirano.\n\n");
    printf("\tDungeon Crawler eh uma jornada emocionante atraves do perigo e da intriga, onde a coragem e a determinacao de um cavaleiro sao testadas ao maximo em sua busca por justica e liberdade\n\n");

    printf("\n\tPressione qualquer tecla para voltar ao menu...");
    getch();
    system("cls");
}
void tutorial() {
    system("cls");
    textColor(WHITE, _BLACK);
    printf("Bem-vindo ao tutorial!\n");
    printf("Instrucoes:\n");
    printf("- Use as teclas 'W', 'A', 'S' e 'D' para mover o jogador pelo labirinto.\n");
    printf("- Seu objetivo eh chegar na porta (D) sem ser pego pelos monstros (X) e (Y).\n");
    printf("- Pegue a chave (@) ou interaja com o botao (O) para abrir as portas.\n");
    printf("- Pressione 'I' para interagir com objetos especiais, como pegar a chave.\n");
    printf("- De teleporte entre o mapa interagindo com o (>).\n");
    printf("- Evite os espinhos (#) e as paredes (*).\n");
    printf("- Boa sorte!\n");

    printf("\nPressione qualquer tecla para voltar ao menu...");
    getch();
    system("cls");
}


void GameOver(){
    if (life == 0)
    {
         system("cls");
            printf("Game Over!\n");
            system("pause");
            end1 = true;
            end2 = true;
            end3 = true;
    }
    
}

int main()
{
    int opc;
    char lista[4][40]={"Jogar","Historia", "Tutorial", "Sair"};
   int i;
   int j;
    setlocale(LC_ALL,"");
    while(true){
       opc = menu(10,10,4,lista);
   
       if (opc==0){
       break;
       }
       switch (opc)
       {
       case 1:
       for( i = 0; i < 15; i++)
       {
            for( j = 0; j < 15; j++)
            {
                fase1[i][j] = cfase1[i][j];
            }
       }
       for( i = 0; i < 30; i++)
       {
            for( j = 0; j < 30; j++)
            {
                fase2[i][j] = cfase2[i][j];
                linha1 = 13;
                coluna1 = 2;
            }
       }
       for( i = 0; i < 60; i++)
       {
            for( j = 0; j < 60; j++)
            {
                linha1 = 13;
                coluna1 = 2;
                fase3[i][j] = cfase3[i][j];
            }
       }
       
       end1 = false;
       system("cls");
       resetGame1();
       printf("\033[1;32m");
       printf("Vida: %d", life);
       GameOver();
   
        linhaCol1(linha1, coluna1);
        printf("\033[1;34m");
        printf("&");
        
  
   
    while(!end1){
        tecla = getch();
       
        switch(tecla){
            case 'w':
            case 'W':
            if(linha1 > 0 && fase1[linha1 -1][coluna1]  != parede)
                    {
                        if(coluna1 > 0 && fase1[linha1 - 1][coluna1]  != door_closed)
                    		{
                    			linha1--;
                    		}
                    }
                     if(fase1[linha1][coluna1] == espinho)
                    {
                        linha1 = 13;
                        coluna1 = 2;
                        life--;
                    }
                break;
            case 'a':
            case 'A':
            if(linha1 < 14 && fase1[linha1][coluna1 - 1]  != parede)
                    {   
                    coluna1--;
                    }
                    if(fase1[linha1][coluna1] == espinho)
                    {
                        linha1 = 13;
                        coluna1 = 2;
                        life--;
                    }
                    break;
            case 's':
            case 'S':
             if(linha1 < 14 && fase1[linha1 + 1][coluna1]  != parede)
                    {   
                    linha1++;
                    }
                    if(fase1[linha1][coluna1] == espinho)
                    {
                        linha1 = 13;
                        coluna1 = 2;
                        life--;
                    }
                    break;
            case 'd':
            case 'D':
            if(coluna1 < 14 && fase1[linha1][coluna1 + 1]  != parede)
                        {
                            if(coluna1 < 14 && fase1[linha1][coluna1 + 1]  != door_closed)
                            {
                                coluna1++;
                            }
                    }
                    if(fase1[linha1][coluna1] == espinho)
                    {
                        linha1 = 13;
                        coluna1 = 2;
                        life--;
                    }
                    break;
            case 'i':
            case 'I':
            if(fase1[linha1][coluna1] == key)
                {
                    havekey = true;
                    fase1[linha1][coluna1] = vazio;
                }

              
                if (fase1[linha1][coluna1 + 1] == door_closed && havekey) 
                {
                    fase1[linha1][coluna1 + 1] = door_open;
                }
                
                
                default:
                break;
        }
       
       
    system("cls");
    imprimirMapa(fase1);
    printf("\033[1;32mVida: %d", life);
    linhaCol1(linha1, coluna1);
    printf("\033[1;34m");
    printf("&");

    resetGame1();
   
     if (fase1[linha1][coluna1] == door_open) {
            system("cls");
            resetGame2();
            printf("\033[1;32m");
            printf("Vida: %d", life);
             linhaCol1(linha2, coluna2);
             printf("\033[1;34m");
             printf("&");

 while(!end1){
        tecla = getch();
       
        switch(tecla){
            case 'w':
            case 'W':
            if(linha2 > 0 && fase2[linha2 -1][coluna2]  != parede)
                    {
                        if(coluna2 > 0 && fase2[linha2 - 1][coluna2]  != door2)
                    		{
                    			linha2--;
                    		}
                     if(fase2[linha2][coluna2] == espinho)
                    {
                        linha2 = 28;
                        coluna2 = 3;
                        life--;
                    }
                    if(mlinha > 0 && fase2[mlinha +1][mcoluna]  != parede)
                    {
                        if(mcoluna > 0 && fase2[mlinha + 1][mcoluna]  != door2)
                    		{
                    			mlinha++;
                    		}
                    }
                    }
                break;
            case 'a':
            case 'A':
            if(linha2  < 29 && fase2[linha2][coluna2 - 1]  != parede)
                    {   
                    coluna2--;
                    }
                if(fase2[linha2][coluna2] == espinho)
                    {
                        linha2 = 28;
                        coluna2 = 3;
                        life--;
                    }
                if(mlinha < 29 && fase2[mlinha ][mcoluna +1]  != parede)
                    {
                if(mlinha< 29 && fase2[mlinha][mcoluna +1]  != door2)
                    		{
                    			mcoluna++;
                    		}
                    }
                    break;
            case 's':
            case 'S':
             if(linha2 < 29 && fase2[linha2 + 1][coluna2]  != parede)
                    {   
                    linha2++;
                    }
                    if(fase2[linha2][coluna2] == espinho)
                    {
                        linha2 = 28;
                        coluna2 = 3;
                        life--;
                    }
                    if(mlinha < 29 && fase2[mlinha -1][mcoluna]  != parede)
                    {
                        if(mlinha < 29 && fase2[mlinha - 1][mcoluna]  != door2)
                    		{
                    			mlinha--;
                    		}
                    }
                    break;
            case 'd':
            case 'D':
        if(coluna2 < 29 && fase2[linha2][coluna2 + 1]  != parede)
                        {
            if(coluna2 < 29 && fase2[linha2][coluna2 + 1]  != door2)
                            {
                                coluna2++;
                            }
                    }
            if(fase2[linha2][coluna2] == espinho)
                    {
                        linha2 = 28;
                        coluna2 = 3;
                        life--;
                    }
            if(mlinha < 29 && fase2[mlinha][mcoluna -1]  != parede)
                    {
            if(mcoluna< 29 && fase2[mlinha][mcoluna -1]  != door2)
                    		{
                    			mcoluna--;
                    		}
                    }
                    break;
            case 'i':
            case 'I':
            if(fase2[linha2][coluna2] == key)
                {
                    havekey = true;
                    fase2[linha2][coluna2] = vazio;
                }

              
                if (fase2[linha2][coluna2 + 1] == dc && havekey) 
                {
                    fase2[linha2][coluna2 + 1] = od2;
                }

                  if (fase2[linha2][coluna2] == button1) 
                {
                    pressbutton = true;
                }

                if (fase2[linha2][coluna2 + 1] == door2 && pressbutton) 
                {
                    fase2[linha2][coluna2 + 1] = od;
                }
                if(fase2[linha2][coluna2] == tp1f2)
                {
                    presstp = true;
                    fase2[linha2][coluna2] = linha2= 27; coluna2 = 26;;
                }
                
                
            default:
                break;
        }
             system("cls");
             imprimirMapa2(fase2);
             printf("\033[1;32m");
             printf("Vida: %d", life);
             linhaCol1(linha2, coluna2);
             printf("\033[1;34m");
             printf("&");
             linhaCol1(mlinha, mcoluna);
             printf("X");
             GameOver();
             resetGame2();  
        
     
    
        if (fase2[linha2][coluna2] == od2) {
             system("cls");
             resetGame3();
             printf("\033[1;32m");
             printf("Vida: %d", life);
             linhaCol1(linha3, coluna3);
             printf("\033[1;34m");
             printf("&");
          
            while(!end1){
        tecla = getch();
       
        switch(tecla){
            case 'w':
            case 'W':
            if(linha3 > 0 && fase3[linha3 -1][coluna3]  != parede)
                    {
                        if(coluna3 > 0 && fase3[linha3 - 1][coluna3]  != doorf31 && doorf32 && door_closed)
                    		{
                    			linha3--;
                    		}
                     if(fase3[linha3][coluna3] == espinho)
                    {
                        linha3 = 58;
                        coluna3 = 3;
                        life--;
                    }
                   
                    }
            if(mlinha2 > 0 && fase3[mlinha2 +1][mcoluna2]  != parede)
                    {
                        if(mcoluna2 > 0 && fase2[mlinha2 + 1][mcoluna2]  != doorf31 && doorf32 && door_closed)
                    		{
                    			mlinha2++;
                    		}
                    }
                break;
            case 'a':
            case 'A':
            if(linha3  < 59 && fase3[linha3][coluna3 - 1]  != parede)
                    {   
                    coluna3--;
                    }
                if(fase3[linha3][coluna3] == espinho)
                    {
                        linha3 = 58;
                        coluna3 = 3;
                        life--;
                    }
            if(mlinha2 < 59 && fase3[mlinha2 ][mcoluna2 +1]  != parede)
                    {
                        if(mcoluna2 > 0 && fase3[mlinha2 ][mcoluna2+1]  != doorf31 && doorf32 && door_closed)
                    		{
                    			mcoluna2++;
                    		}
                    }
               
                    
                    break;
            case 's':
            case 'S':
             if(linha3 < 59 && fase3[linha3 +1][coluna3]  != parede)
                    {   
                    linha3++;
                    }
                    if(fase3[linha3][coluna3] == espinho)
                    {
                        linha3 = 58;
                        coluna3 = 3;
                        life--;
                    }
            if(mlinha2 < 59 && fase3[mlinha2 -1][mcoluna2]  != parede)
                    {
                        if(mcoluna2 > 0 && fase3[mlinha2 - 1][mcoluna2]  != doorf31 && doorf32 && door_closed)
                    		{
                    			mlinha2--;
                    		}
                    }
                    break;
            case 'd':
            case 'D':
        if(coluna3 < 59 && fase3[linha3][coluna3 + 1]  != parede)
                        {
            if(coluna3 < 59 && fase3[linha3][coluna3 + 1]  != doorf31 && doorf32 & door_closed)
                            {
                                coluna3++;
                            }
                    }
            if(fase3[linha3][coluna3] == espinho)
                    {
                        linha3 = 58;
                        coluna3 = 3;
                        life--;
                    }
              if(mlinha2 < 59 && fase3[mlinha2 ][mcoluna2 -1]  != parede)
                    {
                        if(mcoluna2 > 0 && fase3[mlinha2 ][mcoluna2-1]  != doorf31 && doorf32 && door_closed)
                    		{
                    			mcoluna2--;
                    		}
                    }
                    break;
            case 'i':
            case 'I':
            if(fase3[linha3][coluna3] == key)
                {
                    havekey = true;
                    fase3[linha3][coluna3] = vazio;
                }

              
                if (fase3[linha3][coluna3 -1] == door_closed && havekey) 
                {
                    fase3[linha3][coluna3 -1] = door_open;
                }

                //porta botão 1
                  if (fase3[linha3][coluna3] == buttonf31) 
                {
                    pressbutton1 = true;
                }
                if (fase3[linha3][coluna3 + 1] == doorf31 && pressbutton1) 
                {
                    fase3[linha3][coluna3 + 1] = doorfo31;
                }
                //porta botão 2
                    if (fase3[linha3][coluna3] == buttonf32) 
                {
                    pressbutton2 = true;
                }
                
                if (fase3[linha3][coluna3 + 1] == doorf32 && pressbutton2) 
                {
                    fase3[linha3][coluna3 + 1] = doorfo32;
                }

                //tp1 

                 if(fase3[linha3][coluna3] == tp1f3)
                {
                    presstp = true;
                    fase3[linha3][coluna3] = linha3= 2; coluna3 = 2;;
                }

                 //tp2

                 if(fase3[linha3][coluna3] == tp3f3)
                {
                    presstp = true;
                    fase3[linha3][coluna3] = linha3= 2; coluna3 = 43;;
                }


                
                
            default:
                break;
        }
     
        system("cls");
             imprimirMapa3(fase3);
             printf("\033[1;32m");
             printf("Vida: %d", life);
             linhaCol1(linha3, coluna3);
             printf("\033[1;34m");
             printf("&");
             linhaCol1(mlinha2, mcoluna2);
             printf("Y");
             GameOver();
             resetGame3();

              if(fase3[linha3][coluna3] == WIN)
                {
                    system("cls");
                    
printf("\n\n\n\t\t\t\t\t");
printf("#     # ####### #     #      #     #  ###  #     #      ### ###\n");
printf("\t\t\t\t\t #   #  #     # #     #      #  #  #   #   ##    #      ### ###\n");
printf("\t\t\t\t\t  # #   #     # #     #      #  #  #   #   # #   #      ### ###\n");
printf("\t\t\t\t\t   #    #     # #     #      #  #  #   #   #  #  #       #   #\n");
printf("\t\t\t\t\t   #    #     # #     #      #  #  #   #   #   # # \n");
printf("\t\t\t\t\t   #    #     # #     #      #  #  #   #   #    ##      ### ###\n");
printf("\t\t\t\t\t   #    #######  #####        ## ##   ###  #     #      ### ###\n");

                    system("pause");
                    exit(0);
                }
            }
            }
    }
       }
   
    }
    case 2:
    Hist();
    break;
    case 3:
    tutorial();
    break;
    case 4:
    system("cls");
    system("pause");
    exit(0);
    break;

          break;
       
       default:
          break;
       }
   
    }
  textColor(WHITE, _BLACK);
  linhaCol(24,1);
  printf("");
 
  return 0;
}
